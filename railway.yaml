# Railway deployment configuration for Sneaker Authentication API
# Railway offers better memory management than Render

build:
  builder: dockerfile
  dockerfilePath: ./Dockerfile

deploy:
  startCommand: python app.py
  restartPolicyType: on_failure
  restartPolicyMaxRetries: 3

# Environment variables for memory optimization
variables:
  PORT: 8000
  PYTHON_VERSION: "3.11"
  PYTHONUNBUFFERED: "1"
  PYTHONDONTWRITEBYTECODE: "1"
  PYTHONMALLOC: "malloc"
  PYTHONDEVMODE: "0"
  PYTHONHASHSEED: "0"

# Railway-specific optimizations
railway:
  # Use Railway's optimized Python runtime
  runtime: python
  # Memory optimization
  memoryLimit: 512MB
  # Auto-scaling based on demand
  autoScaling:
    enabled: true
    minInstances: 1
    maxInstances: 3
    targetCPUUtilization: 70
    targetMemoryUtilization: 80

# Resource allocation
resources:
  cpu: 0.5
  memory: 512MB
  # Railway allows burst CPU usage
  burstCPU: 1.0
